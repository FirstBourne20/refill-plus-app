<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Refill+ - Premium Flavored Water Delivery</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            overflow-x: hidden;
            line-height: 1.5;
        }

        .app-container {
            max-width: 390px;
            margin: 0 auto;
            background: white;
            min-height: 100vh;
            position: relative;
            box-shadow: 0 0 30px rgba(0,0,0,0.1);
        }

        .watermark-logo {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            opacity: 0.03;
            z-index: 1;
            pointer-events: none;
            font-size: 200px;
        }

        .header {
            background: linear-gradient(135deg, #ff6b35 0%, #d2691e 50%, #8b0000 100%);
            color: white;
            padding: 40px 20px 20px;
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -20px;
            width: 150px;
            height: 150px;
            background: rgba(255,255,255,0.1);
            border-radius: 50%;
            animation: float 6s ease-in-out infinite;
        }

        .simple-header {
            background: linear-gradient(135deg, #ff6b35 0%, #d2691e 50%, #8b0000 100%);
            color: white;
            padding: 40px 20px 20px;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .back-btn {
            background: none;
            border: none;
            color: white;
            font-size: 20px;
            cursor: pointer;
            padding: 8px;
            border-radius: 50%;
            transition: background 0.3s ease;
        }

        .back-btn:hover {
            background: rgba(255,255,255,0.2);
        }

        .page-title {
            font-size: 24px;
            font-weight: 700;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            50% { transform: translateY(-20px) rotate(180deg); }
        }

        .location {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 14px;
            margin-bottom: 15px;
            font-weight: 500;
        }

        .greeting {
            font-size: 26px;
            font-weight: 700;
            margin-bottom: 8px;
        }

        .subtitle {
            font-size: 15px;
            opacity: 0.9;
            font-weight: 400;
            margin-bottom: 20px;
        }

        .quick-profile {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: rgba(255,255,255,0.15);
            border-radius: 20px;
            padding: 16px 20px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.2);
        }

        .mini-profile {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .mini-photo {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            border: 2px solid rgba(255,255,255,0.8);
            object-fit: cover;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
        }

        .mini-info {
            display: flex;
            flex-direction: column;
            gap: 2px;
        }

        .mini-name {
            font-size: 16px;
            font-weight: 700;
            color: white;
        }

        .mini-status {
            font-size: 12px;
            color: rgba(255,255,255,0.8);
            font-weight: 500;
        }

        .mini-rewards {
            text-align: right;
            min-width: 120px;
        }

        .points-display {
            font-size: 18px;
            font-weight: 700;
            color: #ffd700;
            margin-bottom: 6px;
            text-shadow: 0 1px 2px rgba(0,0,0,0.3);
        }

        .mini-progress-bar {
            width: 100%;
            height: 6px;
            background: rgba(255,255,255,0.3);
            border-radius: 3px;
            overflow: hidden;
            margin-bottom: 4px;
        }

        .mini-progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #ffd700, #ff8c00, #ff6b35);
            border-radius: 3px;
            transition: width 0.8s ease;
        }

        .progress-label {
            font-size: 11px;
            color: rgba(255,255,255,0.8);
            font-weight: 500;
        }

        .delivery-toggle {
            display: flex;
            margin: 20px;
            background: #f1f5f9;
            border-radius: 25px;
            padding: 4px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
            border: 1px solid #e2e8f0;
        }

        .toggle-btn {
            flex: 1;
            padding: 14px 20px;
            border: none;
            background: transparent;
            border-radius: 21px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            position: relative;
            overflow: hidden;
        }

        .toggle-btn.active {
            background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);
            color: white;
            box-shadow: 0 4px 15px rgba(59, 130, 246, 0.4);
            transform: translateY(-1px);
        }

        .toggle-btn:not(.active) {
            color: #64748b;
        }

        .toggle-btn:not(.active):hover {
            color: #3b82f6;
            background: rgba(59, 130, 246, 0.1);
        }

        .search-bar {
            margin: 20px;
            position: relative;
        }

        .search-input {
            width: 100%;
            padding: 16px 55px 16px 20px;
            border: 2px solid #e2e8f0;
            border-radius: 25px;
            background: #ffffff;
            font-size: 16px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
            transition: all 0.3s ease;
        }

        .search-input:focus {
            outline: none;
            border-color: #ff6b35;
            box-shadow: 0 4px 20px rgba(255, 107, 53, 0.3);
        }

        .search-btn {
            position: absolute;
            right: 8px;
            top: 50%;
            transform: translateY(-50%);
            background: linear-gradient(135deg, #8b0000 0%, #722f37 100%);
            color: white;
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .search-btn:hover {
            background: linear-gradient(135deg, #a52a2a 0%, #8b0000 100%);
            transform: translateY(-50%) scale(1.05);
        }

        .page {
            padding-bottom: 100px;
        }

        .page.hidden {
            display: none;
        }

        .categories {
            padding: 0 20px 20px;
        }

        .section-title {
            font-size: 20px;
            font-weight: 700;
            color: #1e293b;
            margin-bottom: 20px;
        }

        .category-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 16px;
        }

        .category-item {
            text-align: center;
            cursor: pointer;
            transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .category-item:hover {
            transform: translateY(-8px);
        }

        .category-item:active {
            transform: translateY(-4px);
        }

        .category-icon {
            width: 65px;
            height: 65px;
            border-radius: 18px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 28px;
            margin: 0 auto 10px;
            box-shadow: 0 6px 20px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
        }

        .category-item:hover .category-icon {
            box-shadow: 0 8px 30px rgba(0,0,0,0.2);
        }

        .category-text {
            font-size: 13px;
            color: #475569;
            font-weight: 600;
        }

        .featured-section {
            padding: 25px;
            background: linear-gradient(135deg, #8b0000 0%, #a52a2a 50%, #cd853f 100%);
            margin: 20px;
            border-radius: 24px;
            color: white;
            position: relative;
            overflow: hidden;
        }

        .featured-section::before {
            content: '';
            position: absolute;
            top: -30px;
            right: -30px;
            width: 100px;
            height: 100px;
            background: rgba(255,255,255,0.15);
            border-radius: 50%;
            animation: pulse 4s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); opacity: 0.5; }
            50% { transform: scale(1.3); opacity: 0.2; }
        }

        .featured-title {
            font-size: 22px;
            font-weight: 700;
            margin-bottom: 8px;
        }

        .featured-subtitle {
            font-size: 15px;
            opacity: 0.9;
            margin-bottom: 18px;
            line-height: 1.4;
        }

        .order-btn {
            background: white;
            color: #8b0000;
            border: none;
            padding: 14px 28px;
            border-radius: 25px;
            font-weight: 700;
            font-size: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 20px rgba(0,0,0,0.2);
        }

        .order-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 30px rgba(0,0,0,0.3);
        }

        .products-section {
            padding: 20px;
        }

        .product-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 16px;
        }

        .product-card {
            background: white;
            border-radius: 20px;
            box-shadow: 0 6px 20px rgba(0,0,0,0.08);
            overflow: hidden;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            cursor: pointer;
            border: 1px solid #f1f5f9;
        }

        .product-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 12px 40px rgba(0,0,0,0.15);
            border-color: #e2e8f0;
        }

        .product-image {
            height: 130px;
            background: linear-gradient(45deg, #ff6b35, #d2691e, #a52a2a);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 42px;
            color: white;
        }

        .product-info {
            padding: 16px;
        }

        .product-name {
            font-weight: 700;
            color: #1e293b;
            margin-bottom: 6px;
            font-size: 15px;
        }

        .product-desc {
            font-size: 13px;
            color: #64748b;
            margin-bottom: 12px;
            line-height: 1.4;
        }

        .product-price {
            color: #ff6b35;
            font-weight: 700;
            font-size: 17px;
        }

        .profile-header {
            background: linear-gradient(135deg, #ff6b35 0%, #d2691e 50%, #8b0000 100%);
            padding: 40px 20px 30px;
            text-align: center;
            color: white;
            position: relative;
            overflow: hidden;
        }

        .profile-header::before {
            content: '';
            position: absolute;
            top: -50px;
            right: -50px;
            width: 150px;
            height: 150px;
            background: rgba(255,255,255,0.1);
            border-radius: 50%;
            animation: float 6s ease-in-out infinite;
        }

        .profile-photo {
            position: relative;
            display: inline-block;
            margin-bottom: 20px;
        }

        .profile-photo img {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            border: 4px solid white;
            box-shadow: 0 6px 20px rgba(0,0,0,0.2);
            object-fit: cover;
        }

        .edit-photo-btn {
            position: absolute;
            bottom: 5px;
            right: 5px;
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: #8b0000;
            border: none;
            color: white;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .edit-photo-btn:hover {
            background: #a52a2a;
            transform: scale(1.1);
        }

        .profile-name {
            font-size: 26px;
            font-weight: 700;
            margin-bottom: 8px;
        }

        .profile-email {
            opacity: 0.9;
            margin-bottom: 8px;
            font-size: 15px;
        }

        .profile-member {
            opacity: 0.8;
            font-size: 14px;
        }

        .rewards-section {
            padding: 25px 20px;
            background: white;
            margin: 20px;
            border-radius: 24px;
            box-shadow: 0 6px 25px rgba(0,0,0,0.08);
            border: 1px solid #f1f5f9;
        }

        .rewards-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
        }

        .rewards-header h3 {
            color: #1e293b;
            font-size: 20px;
            font-weight: 700;
        }

        .rewards-points {
            background: linear-gradient(135deg, #8b0000, #a52a2a);
            color: white;
            padding: 10px 18px;
            border-radius: 20px;
            font-weight: 700;
            font-size: 14px;
        }

        .progress-container {
            margin-bottom: 30px;
        }

        .progress-bar {
            width: 100%;
            height: 14px;
            background: #f1f5f9;
            border-radius: 7px;
            overflow: hidden;
            margin-bottom: 12px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #ff6b35, #d2691e, #a52a2a);
            border-radius: 7px;
            transition: width 1s cubic-bezier(0.4, 0, 0.2, 1);
            width: 0%;
        }

        .progress-text {
            display: flex;
            justify-content: space-between;
            font-size: 13px;
            color: #64748b;
            font-weight: 500;
        }

        .rewards-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 16px;
        }

        .reward-item {
            text-align: center;
            padding: 20px 16px;
            border-radius: 18px;
            transition: all 0.3s ease;
        }

        .reward-item.unlocked {
            background: linear-gradient(135deg, #dcfce7, #bbf7d0);
            border: 2px solid #22c55e;
        }

        .reward-item.locked {
            background: #f8fafc;
            border: 2px solid #e2e8f0;
            opacity: 0.7;
        }

        .reward-icon {
            font-size: 30px;
            margin-bottom: 10px;
            display: block;
        }

        .reward-text {
            font-weight: 700;
            color: #1e293b;
            margin-bottom: 6px;
            font-size: 14px;
        }

        .reward-status {
            font-size: 12px;
            font-weight: 600;
        }

        .reward-item.unlocked .reward-status {
            color: #16a34a;
        }

        .reward-item.locked .reward-status {
            color: #64748b;
        }

        .profile-section {
            padding: 20px;
        }

        .profile-section h3 {
            color: #1e293b;
            margin-bottom: 16px;
            font-size: 20px;
            font-weight: 700;
        }

        .profile-menu {
            background: white;
            border-radius: 20px;
            box-shadow: 0 6px 25px rgba(0,0,0,0.08);
            overflow: hidden;
            border: 1px solid #f1f5f9;
        }

        .menu-item {
            display: flex;
            align-items: center;
            padding: 20px;
            border-bottom: 1px solid #f1f5f9;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .menu-item:last-child {
            border-bottom: none;
        }

        .menu-item:hover {
            background: #f8fafc;
        }

        .menu-icon {
            font-size: 18px;
            margin-right: 16px;
            width: 24px;
            text-align: center;
        }

        .menu-text {
            flex: 1;
            font-weight: 600;
            color: #1e293b;
            font-size: 15px;
        }

        .menu-arrow {
            color: #cbd5e1;
            font-size: 18px;
        }

        /* Cart styles */
        .cart-content {
            padding: 20px;
        }

        .cart-item {
            background: white;
            border-radius: 16px;
            padding: 16px;
            margin-bottom: 16px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
            border: 1px solid #f1f5f9;
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .cart-item-image {
            width: 60px;
            height: 60px;
            background: linear-gradient(45deg, #ff6b35, #d2691e);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            color: white;
        }

        .cart-item-info {
            flex: 1;
        }

        .cart-item-name {
            font-weight: 700;
            color: #1e293b;
            margin-bottom: 4px;
        }

        .cart-item-price {
            color: #64748b;
            font-size: 14px;
        }

        .cart-item-controls {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .quantity-btn {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            border: none;
            background: #f1f5f9;
            color: #64748b;
            cursor: pointer;
            font-weight: 700;
            transition: all 0.3s ease;
        }

        .quantity-btn:hover {
            background: #ff6b35;
            color: white;
        }

        .quantity-display {
            font-weight: 700;
            color: #1e293b;
            min-width: 24px;
            text-align: center;
        }

        .remove-btn {
            background: #ef4444;
            color: white;
            border: none;
            width: 32px;
            height: 32px;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .remove-btn:hover {
            background: #dc2626;
            transform: scale(1.1);
        }

        .cart-summary {
            background: white;
            border-radius: 20px;
            padding: 24px;
            margin: 20px;
            box-shadow: 0 6px 25px rgba(0,0,0,0.08);
            border: 1px solid #f1f5f9;
            position: sticky;
            bottom: 100px;
        }

        .summary-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 12px;
            color: #64748b;
        }

        .summary-row.total {
            border-top: 1px solid #e2e8f0;
            padding-top: 12px;
            font-weight: 700;
            font-size: 18px;
            color: #1e293b;
        }

        .checkout-btn {
            width: 100%;
            background: linear-gradient(135deg, #ff6b35 0%, #d2691e 100%);
            color: white;
            border: none;
            padding: 16px;
            border-radius: 25px;
            font-weight: 700;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 16px;
        }

        .checkout-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(255, 107, 53, 0.4);
        }

        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #64748b;
        }

        .empty-state-icon {
            font-size: 64px;
            margin-bottom: 20px;
            opacity: 0.5;
        }

        .empty-state-title {
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 8px;
            color: #1e293b;
        }

        .empty-state-text {
            margin-bottom: 24px;
            line-height: 1.5;
        }

        .empty-state-btn {
            background: linear-gradient(135deg, #ff6b35 0%, #d2691e 100%);
            color: white;
            border: none;
            padding: 14px 28px;
            border-radius: 25px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .empty-state-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(255, 107, 53, 0.4);
        }

        /* Search Page Styles */
        .filter-tabs {
            display: flex;
            gap: 8px;
            padding: 20px 20px 0;
            overflow-x: auto;
        }

        .filter-tab {
            background: #f1f5f9;
            border: none;
            padding: 10px 16px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 14px;
            color: #64748b;
            cursor: pointer;
            transition: all 0.3s ease;
            white-space: nowrap;
        }

        .filter-tab.active {
            background: linear-gradient(135deg, #ff6b35, #d2691e);
            color: white;
        }

        .search-results {
            padding: 20px;
        }

        .result-count {
            font-size: 14px;
            color: #64748b;
            margin-bottom: 20px;
        }

        /* Orders Page Styles */
        .orders-content {
            padding: 20px;
        }

        .order-item {
            background: white;
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 16px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
            border: 1px solid #f1f5f9;
        }

        .order-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
        }

        .order-id {
            font-weight: 700;
            color: #1e293b;
        }

        .order-status {
            padding: 6px 12px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 700;
        }

        .order-status.delivered {
            background: #dcfce7;
            color: #16a34a;
        }

        .order-status.preparing {
            background: #fef3c7;
            color: #d97706;
        }

        .order-status.cancelled {
            background: #fee2e2;
            color: #dc2626;
        }

        .order-items {
            margin-bottom: 16px;
        }

        .order-item-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 0;
            border-bottom: 1px solid #f1f5f9;
        }

        .order-item-row:last-child {
            border-bottom: none;
        }

        .order-item-details {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .order-item-emoji {
            font-size: 20px;
        }

        .order-item-info h4 {
            font-weight: 600;
            color: #1e293b;
            margin-bottom: 2px;
        }

        .order-item-info p {
            font-size: 12px;
            color: #64748b;
        }

        .order-item-price {
            font-weight: 700;
            color: #ff6b35;
        }

        .order-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-top: 1px solid #e2e8f0;
            padding-top: 16px;
        }

        .order-date {
            font-size: 12px;
            color: #64748b;
        }

        .order-total {
            font-weight: 700;
            color: #1e293b;
            font-size: 16px;
        }

        .reorder-btn {
            background: linear-gradient(135deg, #ff6b35, #d2691e);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 16px;
            font-weight: 600;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .reorder-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 15px rgba(255, 107, 53, 0.3);
        }

        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            max-width: 390px;
            width: 100%;
            background: white;
            border-top: 1px solid #f1f5f9;
            display: flex;
            justify-content: space-around;
            padding: 12px 0 20px;
            box-shadow: 0 -4px 25px rgba(0,0,0,0.1);
        }

        .nav-item {
            text-align: center;
            cursor: pointer;
            padding: 8px 12px;
            transition: all 0.3s ease;
            border-radius: 16px;
            position: relative;
        }

        .nav-item:hover {
            background: #f8fafc;
        }

        .nav-item.active {
            color: #ff6b35;
            background: #fff5f0;
        }

        .nav-icon {
            font-size: 20px;
            margin-bottom: 4px;
            display: block;
        }

        .nav-text {
            font-size: 11px;
            font-weight: 600;
        }

        .badge {
            position: absolute;
            top: 2px;
            right: 8px;
            background: #ef4444;
            color: white;
            font-size: 10px;
            padding: 2px 6px;
            border-radius: 10px;
            min-width: 18px;
            text-align: center;
            font-weight: 700;
        }

        /* Notification styles */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: linear-gradient(135deg, #ff6b35, #d2691e, #8b0000);
            color: white;
            padding: 16px 20px;
            border-radius: 16px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.3);
            z-index: 1000;
            max-width: 280px;
            transform: translateX(100%);
            transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .notification.show {
            transform: translateX(0);
        }

        .notification-title {
            font-weight: 700;
            margin-bottom: 4px;
            font-size: 14px;
        }

        .notification-body {
            font-size: 13px;
            opacity: 0.9;
        }

        .notification-total {
            font-size: 12px;
            margin-top: 6px;
            opacity: 0.8;
        }

        /* Loading animation */
        @keyframes shimmer {
            0% { background-position: -200px 0; }
            100% { background-position: 200px 0; }
        }

        .animate-entrance {
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.6s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .animate-entrance.visible {
            opacity: 1;
            transform: translateY(0);
        }

        /* Additional responsive styles */
        @media (max-width: 380px) {
            .app-container {
                max-width: 100%;
            }
            
            .header, .simple-header {
                padding: 35px 16px 16px;
            }
            
            .delivery-toggle,
            .search-bar,
            .categories,
            .products-section,
            .featured-section {
                margin-left: 16px;
                margin-right: 16px;
            }
            
            .product-grid {
                gap: 12px;
            }
            
            .category-grid {
                gap: 12px;
            }
        }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- Watermark Logo -->
        <div class="watermark-logo">💧</div>
        
        <!-- Home Page -->
        <div id="home-page" class="page">
            <!-- Header -->
            <header class="header">
                <div class="location">
                    <span>📍</span>
                    <span>Downtown District</span>
                    <span style="margin-left: auto;" id="delivery-time">⚡ 15 min</span>
                </div>
                <div class="greeting">Hi, Sarah!</div>
                <div class="subtitle">Stay hydrated with premium flavored water</div>
                
                <!-- Quick Profile Access in Header -->
                <div class="quick-profile" onclick="navigateToPage('profile')">
                    <div class="mini-profile">
                        <img src="https://images.unsplash.com/photo-1494790108755-2616b612b786?w=60&h=60&fit=crop&crop=face" alt="Profile" class="mini-photo">
                        <div class="mini-info">
                            <div class="mini-name">Sarah Johnson</div>
                            <div class="mini-status">Premium Member</div>
                        </div>
                    </div>
                    <div class="mini-rewards">
                        <div class="points-display">1,247 pts</div>
                        <div class="mini-progress-bar">
                            <div class="mini-progress-fill" style="width: 74%;"></div>
                        </div>
                        <div class="progress-label">74% to next reward</div>
                    </div>
                </div>
            </header>

            <!-- Pickup/Delivery Toggle -->
            <div class="delivery-toggle">
                <button class="toggle-btn active" id="delivery-btn" onclick="toggleDeliveryMode('delivery')">
                    <span>🚚</span>
                    <span>Delivery</span>
                </button>
                <button class="toggle-btn" id="pickup-btn" onclick="toggleDeliveryMode('pickup')">
                    <span>🏪</span>
                    <span>Pickup</span>
                </button>
            </div>

            <!-- Search Bar -->
            <div class="search-bar">
                <input type="text" class="search-input" placeholder="Search for flavored waters..." aria-label="Search products" id="main-search">
                <button class="search-btn" onclick="performSearch()" aria-label="Search">🔍</button>
            </div>

            <!-- Categories -->
            <section class="categories">
                <h2 class="section-title">Categories</h2>
                <div class="category-grid">
                    <div class="category-item animate-entrance" onclick="filterByCategory('fruity')">
                        <div class="category-icon" style="background: linear-gradient(45deg, #ffe4e1, #ffc0cb);">🍓</div>
                        <div class="category-text">Fruity</div>
                    </div>
                    <div class="category-item animate-entrance" onclick="filterByCategory('refreshing')">
                        <div class="category-icon" style="background: linear-gradient(45deg, #e0ffff, #b0e0e6);">❄️</div>
                        <div class="category-text">Refreshing</div>
                    </div>
                    <div class="category-item animate-entrance" onclick="filterByCategory('herbal')">
                        <div class="category-icon" style="background: linear-gradient(45deg, #f0fff0, #98fb98);">🌿</div>
                        <div class="category-text">Herbal</div>
                    </div>
                    <div class="category-item animate-entrance" onclick="filterByCategory('energy')">
                        <div class="category-icon" style="background: linear-gradient(45deg, #fff8dc, #f0e68c);">⚡</div>
                        <div class="category-text">Energy</div>
                    </div>
                </div>
            </section>

            <!-- Featured Section -->
            <section class="featured-section animate-entrance">
                <div class="featured-title">Daily Hydration Pack</div>
                <div class="featured-subtitle">6 bottles of premium flavored water delivered fresh to your door</div>
                <button class="order-btn" onclick="addToCart('Daily Hydration Pack', 24.99, '🎁')">Order Now - $24.99</button>
            </section>

            <!-- Products Section -->
            <section class="products-section">
                <h2 class="section-title">Popular Flavors</h2>
                <div class="product-grid" id="product-grid">
                    <div class="product-card animate-entrance" onclick="addToCart('Tropical Burst', 4.99, '🥥')">
                        <div class="product-image">🥥</div>
                        <div class="product-info">
                            <div class="product-name">Tropical Burst</div>
                            <div class="product-desc">Coconut & pineapple infused water</div>
                            <div class="product-price">$4.99</div>
                        </div>
                    </div>
                    
                    <div class="product-card animate-entrance" onclick="addToCart('Berry Bliss', 4.99, '🫐')">
                        <div class="product-image">🫐</div>
                        <div class="product-info">
                            <div class="product-name">Berry Bliss</div>
                            <div class="product-desc">Mixed berry flavored refresher</div>
                            <div class="product-price">$4.99</div>
                        </div>
                    </div>
                    
                    <div class="product-card animate-entrance" onclick="addToCart('Mint Fresh', 4.49, '🌱')">
                        <div class="product-image">🌱</div>
                        <div class="product-info">
                            <div class="product-name">Mint Fresh</div>
                            <div class="product-desc">Cool mint with cucumber essence</div>
                            <div class="product-price">$4.49</div>
                        </div>
                    </div>
                    
                    <div class="product-card animate-entrance" onclick="addToCart('Citrus Splash', 4.79, '🍋')">
                        <div class="product-image">🍋</div>
                        <div class="product-info">
                            <div class="product-name">Citrus Splash</div>
                            <div class="product-desc">Lemon lime energizing water</div>
                            <div class="product-price">$4.79</div>
                        </div>
                    </div>
                </div>
            </section>
        </div>

        <!-- Search Page -->
        <div id="search-page" class="page hidden">
            <div class="simple-header">
                <button class="back-btn" onclick="navigateToPage('home')">←</button>
                <h1 class="page-title">Search</h1>
            </div>

            <div class="search-bar">
                <input type="text" class="search-input" placeholder="Search for flavored waters..." id="search-page-input">
                <button class="search-btn" onclick="performSearchOnPage()">🔍</button>
            </div>

            <div class="filter-tabs">
                <button class="filter-tab active" onclick="filterSearch('all')">All</button>
                <button class="filter-tab" onclick="filterSearch('fruity')">Fruity</button>
                <button class="filter-tab" onclick="filterSearch('refreshing')">Refreshing</button>
                <button class="filter-tab" onclick="filterSearch('herbal')">Herbal</button>
                <button class="filter-tab" onclick="filterSearch('energy')">Energy</button>
                <button class="filter-tab" onclick="filterSearch('premium')">Premium</button>
            </div>

            <div class="search-results">
                <div class="result-count" id="result-count">Showing all products</div>
                <div class="product-grid" id="search-results-grid">
                    <!-- Search results will be populated here -->
                </div>
            </div>
        </div>

        <!-- Cart Page -->
        <div id="cart-page" class="page hidden">
            <div class="simple-header">
                <button class="back-btn" onclick="navigateToPage('home')">←</button>
                <h1 class="page-title">Cart</h1>
            </div>

            <div class="cart-content" id="cart-content">
                <!-- Cart items will be populated here -->
            </div>

            <div class="cart-summary" id="cart-summary" style="display: none;">
                <div class="summary-row">
                    <span>Subtotal:</span>
                    <span id="subtotal">$0.00</span>
                </div>
                <div class="summary-row">
                    <span>Delivery Fee:</span>
                    <span id="delivery-fee">$2.99</span>
                </div>
                <div class="summary-row">
                    <span>Tax:</span>
                    <span id="tax">$0.00</span>
                </div>
                <div class="summary-row total">
                    <span>Total:</span>
                    <span id="total">$0.00</span>
                </div>
                <button class="checkout-btn" onclick="proceedToCheckout()">Proceed to Checkout</button>
            </div>
        </div>

        <!-- Orders Page -->
        <div id="orders-page" class="page hidden">
            <div class="simple-header">
                <button class="back-btn" onclick="navigateToPage('home')">←</button>
                <h1 class="page-title">Orders</h1>
            </div>

            <div class="orders-content">
                <!-- Recent Orders -->
                <div class="order-item">
                    <div class="order-header">
                        <div class="order-id">#ORD-2024-001</div>
                        <div class="order-status delivered">Delivered</div>
                    </div>
                    <div class="order-items">
                        <div class="order-item-row">
                            <div class="order-item-details">
                                <div class="order-item-emoji">🥥</div>
                                <div class="order-item-info">
                                    <h4>Tropical Burst</h4>
                                    <p>Coconut & pineapple infused • Qty: 2</p>
                                </div>
                            </div>
                            <div class="order-item-price">$9.98</div>
                        </div>
                        <div class="order-item-row">
                            <div class="order-item-details">
                                <div class="order-item-emoji">🌱</div>
                                <div class="order-item-info">
                                    <h4>Mint Fresh</h4>
                                    <p>Cool mint with cucumber • Qty: 1</p>
                                </div>
                            </div>
                            <div class="order-item-price">$4.49</div>
                        </div>
                    </div>
                    <div class="order-footer">
                        <div class="order-date">Delivered on Aug 10, 2025</div>
                        <div class="order-total">$17.46</div>
                        <button class="reorder-btn" onclick="reorderItems(['Tropical Burst', 'Mint Fresh'])">Reorder</button>
                    </div>
                </div>

                <div class="order-item">
                    <div class="order-header">
                        <div class="order-id">#ORD-2024-002</div>
                        <div class="order-status preparing">Preparing</div>
                    </div>
                    <div class="order-items">
                        <div class="order-item-row">
                            <div class="order-item-details">
                                <div class="order-item-emoji">🎁</div>
                                <div class="order-item-info">
                                    <h4>Daily Hydration Pack</h4>
                                    <p>6 bottles premium variety • Qty: 1</p>
                                </div>
                            </div>
                            <div class="order-item-price">$24.99</div>
                        </div>
                    </div>
                    <div class="order-footer">
                        <div class="order-date">Ordered today, 2:30 PM</div>
                        <div class="order-total">$27.98</div>
                        <button class="reorder-btn" onclick="trackOrder('ORD-2024-002')">Track Order</button>
                    </div>
                </div>

                <div class="order-item">
                    <div class="order-header">
                        <div class="order-id">#ORD-2024-003</div>
                        <div class="order-status cancelled">Cancelled</div>
                    </div>
                    <div class="order-items">
                        <div class="order-item-row">
                            <div class="order-item-details">
                                <div class="order-item-emoji">🫐</div>
                                <div class="order-item-info">
                                    <h4>Berry Bliss</h4>
                                    <p>Mixed berry flavored • Qty: 3</p>
                                </div>
                            </div>
                            <div class="order-item-price">$14.97</div>
                        </div>
                    </div>
                    <div class="order-footer">
                        <div class="order-date">Cancelled on Aug 9, 2025</div>
                        <div class="order-total">$17.96</div>
                        <button class="reorder-btn" onclick="reorderItems(['Berry Bliss'])">Reorder</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Profile Page -->
        <div id="profile-page" class="page hidden">
            <div class="profile-header">
                <div class="profile-photo">
                    <img src="https://images.unsplash.com/photo-1494790108755-2616b612b786?w=150&h=150&fit=crop&crop=face" alt="Profile Photo" id="profile-img">
                    <button class="edit-photo-btn" onclick="changeProfilePhoto()">📷</button>
                </div>
                <div class="profile-info">
                    <h2 class="profile-name">Sarah Johnson</h2>
                    <p class="profile-email">sarah.j@email.com</p>
                    <p class="profile-member">Premium Member since 2024</p>
                </div>
            </div>

            <div class="rewards-section">
                <div class="rewards-header">
                    <h3>💎 Rewards Progress</h3>
                    <span class="rewards-points">1,247 pts</span>
                </div>
                <div class="progress-container">
                    <div class="progress-bar">
                        <div class="progress-fill" id="progress-fill"></div>
                    </div>
                    <div class="progress-text">
                        <span>247 points to next free refill!</span>
                        <span>74% Complete</span>
                    </div>
                </div>
                <div class="rewards-grid">
                    <div class="reward-item unlocked">
                        <div class="reward-icon">🎉</div>
                        <div class="reward-text">Free Bottle</div>
                        <div class="reward-status">Unlocked!</div>
                    </div>
                    <div class="reward-item unlocked">
                        <div class="reward-icon">⚡</div>
                        <div class="reward-text">10% Off</div>
                        <div class="reward-status">Available</div>
                    </div>
                    <div class="reward-item locked">
                        <div class="reward-icon">🏆</div>
                        <div class="reward-text">Premium Pack</div>
                        <div class="reward-status">1,500 pts</div>
                    </div>
                    <div class="reward-item locked">
                        <div class="reward-icon">👑</div>
                        <div class="reward-text">VIP Status</div>
                        <div class="reward-status">2,500 pts</div>
                    </div>
                </div>
            </div>

            <div class="profile-section">
                <h3>Account Settings</h3>
                <div class="profile-menu">
                    <div class="menu-item" onclick="showSettingsPage('addresses')">
                        <span class="menu-icon">📍</span>
                        <span class="menu-text">Delivery Addresses</span>
                        <span class="menu-arrow">›</span>
                    </div>
                    <div class="menu-item" onclick="showSettingsPage('payment')">
                        <span class="menu-icon">💳</span>
                        <span class="menu-text">Payment Methods</span>
                        <span class="menu-arrow">›</span>
                    </div>
                    <div class="menu-item" onclick="showSettingsPage('notifications')">
                        <span class="menu-icon">🔔</span>
                        <span class="menu-text">Notifications</span>
                        <span class="menu-arrow">›</span>
                    </div>
                    <div class="menu-item" onclick="showSettingsPage('referral')">
                        <span class="menu-icon">🎁</span>
                        <span class="menu-text">Referral Program</span>
                        <span class="menu-arrow">›</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Bottom Navigation -->
        <nav class="bottom-nav">
            <div class="nav-item active" onclick="navigateToPage('home')" aria-label="Home">
                <span class="nav-icon">🏠</span>
                <span class="nav-text">Home</span>
            </div>
            <div class="nav-item" onclick="navigateToPage('search')" aria-label="Search">
                <span class="nav-icon">🔍</span>
                <span class="nav-text">Search</span>
            </div>
            <div class="nav-item" onclick="navigateToPage('cart')" aria-label="Cart" style="position: relative;">
                <span class="nav-icon">🛒</span>
                <span class="nav-text">Cart</span>
                <span class="badge" id="cart-badge">0</span>
            </div>
            <div class="nav-item" onclick="navigateToPage('orders')" aria-label="Orders">
                <span class="nav-icon">📋</span>
                <span class="nav-text">Orders</span>
            </div>
            <div class="nav-item" onclick="navigateToPage('profile')" aria-label="Profile">
                <span class="nav-icon">👤</span>
                <span class="nav-text">Profile</span>
            </div>
        </nav>
    </div>

    <script>
        // App state
        let appState = {
            cartCount: 0,
            cartTotal: 0,
            currentPage: 'home',
            deliveryMode: 'delivery',
            searchQuery: '',
            selectedCategory: 'all',
            cartItems: [],
            currentFilter: 'all'
        };

        // Profile photos array
        const profilePhotos = [
            'https://images.unsplash.com/photo-1494790108755-2616b612b786?w=150&h=150&fit=crop&crop=face',
            'https://images.unsplash.com/photo-1438761681033-6461ffad8d80?w=150&h=150&fit=crop&crop=face',
            'https://images.unsplash.com/photo-1489424731084-a5d8b219a5bb?w=150&h=150&fit=crop&crop=face'
        ];

        // Extended product data
        const products = [
            { name: 'Tropical Burst', price: 4.99, emoji: '🥥', desc: 'Coconut & pineapple infused water', category: 'fruity' },
            { name: 'Berry Bliss', price: 4.99, emoji: '🫐', desc: 'Mixed berry flavored refresher', category: 'fruity' },
            { name: 'Mint Fresh', price: 4.49, emoji: '🌱', desc: 'Cool mint with cucumber essence', category: 'herbal' },
            { name: 'Citrus Splash', price: 4.79, emoji: '🍋', desc: 'Lemon lime energizing water', category: 'energy' },
            { name: 'Arctic Chill', price: 4.29, emoji: '❄️', desc: 'Ultra-refreshing glacier water', category: 'refreshing' },
            { name: 'Strawberry Fields', price: 5.19, emoji: '🍓', desc: 'Sweet strawberry infusion', category: 'fruity' },
            { name: 'Green Tea Zen', price: 4.89, emoji: '🍵', desc: 'Calming green tea blend', category: 'herbal' },
            { name: 'Lightning Bolt', price: 5.49, emoji: '⚡', desc: 'High-caffeine energy water', category: 'energy' },
            { name: 'Premium Pure', price: 6.99, emoji: '💎', desc: 'Ultra-filtered premium water', category: 'premium' },
            { name: 'Mango Tango', price: 5.29, emoji: '🥭', desc: 'Tropical mango flavor', category: 'fruity' }
        ];

        // Initialize app
        document.addEventListener('DOMContentLoaded', function() {
            initializeAnimations();
            initializeProgressBar();
            updateCartDisplay();
            setupMiniPhotoClick();
            populateSearchResults();
        });

        // Toggle delivery mode
        function toggleDeliveryMode(mode) {
            appState.deliveryMode = mode;
            const deliveryBtn = document.getElementById('delivery-btn');
            const pickupBtn = document.getElementById('pickup-btn');
            const deliveryTime = document.getElementById('delivery-time');
            
            if (mode === 'delivery') {
                deliveryBtn.classList.add('active');
                pickupBtn.classList.remove('active');
                deliveryTime.textContent = '⚡ 15 min';
            } else {
                pickupBtn.classList.add('active');
                deliveryBtn.classList.remove('active');
                deliveryTime.textContent = '🏪 Ready in 5 min';
            }
            
            updateCartSummary(); // Update delivery fee
        }

        // Enhanced page navigation
        function navigateToPage(pageName) {
            // Hide all pages
            document.querySelectorAll('.page').forEach(page => {
                page.classList.add('hidden');
            });
            
            // Update navigation active state
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            
            // Find and activate the clicked nav item
            const clickedNavItem = event?.currentTarget || document.querySelector(`[onclick="navigateToPage('${pageName}')"]`);
            if (clickedNavItem && clickedNavItem.classList.contains('nav-item')) {
                clickedNavItem.classList.add('active');
            }
            
            // Show target page
            const targetPage = document.getElementById(`${pageName}-page`);
            if (targetPage) {
                targetPage.classList.remove('hidden');
                appState.currentPage = pageName;
                
                // Page-specific initializations
                if (pageName === 'profile') {
                    setTimeout(() => {
                        const progressFill = document.getElementById('progress-fill');
                        if (progressFill) {
                            progressFill.style.width = '74%';
                        }
                    }, 200);
                } else if (pageName === 'cart') {
                    updateCartDisplay();
                    renderCartItems();
                } else if (pageName === 'search') {
                    populateSearchResults();
                    const searchInput = document.getElementById('search-page-input');
                    if (searchInput) {
                        searchInput.focus();
                    }
                }
            }
            
            // Add navigation animation
            if (clickedNavItem && clickedNavItem.classList.contains('nav-item')) {
                clickedNavItem.style.transform = 'scale(0.95)';
                setTimeout(() => {
                    clickedNavItem.style.transform = 'scale(1)';
                }, 150);
            }
        }

        // Profile photo change
        function changeProfilePhoto() {
            const currentImg = document.getElementById('profile-img');
            const miniImg = document.querySelector('.mini-photo');
            const currentSrc = currentImg.src;
            const currentIndex = profilePhotos.findIndex(photo => currentSrc.includes(photo.split('/')[4]));
            const nextIndex = (currentIndex + 1) % profilePhotos.length;
            
            // Add transition effect
            currentImg.style.transition = 'transform 0.3s ease';
            currentImg.style.transform = 'scale(0.8)';
            
            if (miniImg) {
                miniImg.style.transition = 'transform 0.3s ease';
                miniImg.style.transform = 'scale(0.8)';
            }
            
            setTimeout(() => {
                currentImg.src = profilePhotos[nextIndex];
                currentImg.style.transform = 'scale(1)';
                
                if (miniImg) {
                    miniImg.src = profilePhotos[nextIndex].replace('150&h=150', '60&h=60');
                    miniImg.style.transform = 'scale(1)';
                }
            }, 150);
        }

        // Make mini photo clickable
        function setupMiniPhotoClick() {
            const miniPhoto = document.querySelector('.mini-photo');
            if (miniPhoto) {
                miniPhoto.addEventListener('click', function(e) {
                    e.stopPropagation(); // Prevent triggering parent onclick
                    navigateToPage('profile');
                });
                miniPhoto.style.cursor = 'pointer';
            }
        }

        // Enhanced add to cart function
        function addToCart(itemName, price, emoji) {
            const existingItem = appState.cartItems.find(item => item.name === itemName);
            
            if (existingItem) {
                existingItem.quantity += 1;
            } else {
                appState.cartItems.push({
                    name: itemName,
                    price: price,
                    emoji: emoji,
                    quantity: 1
                });
            }
            
            appState.cartCount++;
            appState.cartTotal += price;
            
            updateCartDisplay();
            updateCartSummary();
            showNotification(itemName, price);
            
            // Add ripple effect
            if (event && event.currentTarget) {
                createRippleEffect(event);
            }
        }

        // Update cart display
        function updateCartDisplay() {
            const cartBadge = document.getElementById('cart-badge');
            if (cartBadge) {
                cartBadge.textContent = appState.cartCount;
                cartBadge.style.display = appState.cartCount > 0 ? 'block' : 'none';
            }
        }

        // Render cart items
        function renderCartItems() {
            const cartContent = document.getElementById('cart-content');
            const cartSummary = document.getElementById('cart-summary');
            
            if (appState.cartItems.length === 0) {
                cartContent.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-state-icon">🛒</div>
                        <div class="empty-state-title">Your cart is empty</div>
                        <div class="empty-state-text">Add some refreshing flavored water to get started!</div>
                        <button class="empty-state-btn" onclick="navigateToPage('home')">Start Shopping</button>
                    </div>
                `;
                cartSummary.style.display = 'none';
                return;
            }
            
            cartSummary.style.display = 'block';
            cartContent.innerHTML = appState.cartItems.map(item => `
                <div class="cart-item">
                    <div class="cart-item-image">${item.emoji}</div>
                    <div class="cart-item-info">
                        <div class="cart-item-name">${item.name}</div>
                        <div class="cart-item-price">${item.price.toFixed(2)} each</div>
                    </div>
                    <div class="cart-item-controls">
                        <button class="quantity-btn" onclick="updateQuantity('${item.name}', -1)">−</button>
                        <span class="quantity-display">${item.quantity}</span>
                        <button class="quantity-btn" onclick="updateQuantity('${item.name}', 1)">+</button>
                        <button class="remove-btn" onclick="removeFromCart('${item.name}')">🗑</button>
                    </div>
                </div>
            `).join('');
        }

        // Update item quantity
        function updateQuantity(itemName, change) {
            const item = appState.cartItems.find(item => item.name === itemName);
            if (item) {
                const oldQuantity = item.quantity;
                item.quantity += change;
                
                if (item.quantity <= 0) {
                    removeFromCart(itemName);
                    return;
                }
                
                appState.cartCount += change;
                appState.cartTotal += (item.price * change);
                
                updateCartDisplay();
                updateCartSummary();
                renderCartItems();
            }
        }

        // Remove item from cart
        function removeFromCart(itemName) {
            const itemIndex = appState.cartItems.findIndex(item => item.name === itemName);
            if (itemIndex > -1) {
                const item = appState.cartItems[itemIndex];
                appState.cartCount -= item.quantity;
                appState.cartTotal -= (item.price * item.quantity);
                
                appState.cartItems.splice(itemIndex, 1);
                
                updateCartDisplay();
                updateCartSummary();
                renderCartItems();
                
                showNotification(`${itemName} removed`, 0);
            }
        }

        // Update cart summary
        function updateCartSummary() {
            const subtotal = appState.cartTotal;
            const deliveryFee = appState.deliveryMode === 'delivery' ? 2.99 : 0;
            const tax = subtotal * 0.08; // 8% tax
            const total = subtotal + deliveryFee + tax;
            
            document.getElementById('subtotal').textContent = `${subtotal.toFixed(2)}`;
            document.getElementById('delivery-fee').textContent = appState.deliveryMode === 'delivery' ? '$2.99' : 'Free';
            document.getElementById('tax').textContent = `${tax.toFixed(2)}`;
            document.getElementById('total').textContent = `${total.toFixed(2)}`;
        }

        // Populate search results
        function populateSearchResults() {
            const searchGrid = document.getElementById('search-results-grid');
            if (!searchGrid) return;
            
            const filteredProducts = filterProducts();
            
            searchGrid.innerHTML = filteredProducts.map(product => `
                <div class="product-card" onclick="addToCart('${product.name}', ${product.price}, '${product.emoji}')">
                    <div class="product-image">${product.emoji}</div>
                    <div class="product-info">
                        <div class="product-name">${product.name}</div>
                        <div class="product-desc">${product.desc}</div>
                        <div class="product-price">${product.price.toFixed(2)}</div>
                    </div>
                </div>
            `).join('');
            
            updateResultCount(filteredProducts.length);
        }

        // Filter products based on current filter and search query
        function filterProducts() {
            let filtered = products;
            
            // Filter by category
            if (appState.currentFilter !== 'all') {
                filtered = filtered.filter(product => product.category === appState.currentFilter);
            }
            
            // Filter by search query
            if (appState.searchQuery) {
                filtered = filtered.filter(product => 
                    product.name.toLowerCase().includes(appState.searchQuery.toLowerCase()) ||
                    product.desc.toLowerCase().includes(appState.searchQuery.toLowerCase())
                );
            }
            
            return filtered;
        }

        // Update result count
        function updateResultCount(count) {
            const resultCount = document.getElementById('result-count');
            if (resultCount) {
                if (appState.searchQuery) {
                    resultCount.textContent = `Found ${count} results for "${appState.searchQuery}"`;
                } else if (appState.currentFilter !== 'all') {
                    resultCount.textContent = `${count} ${appState.currentFilter} products`;
                } else {
                    resultCount.textContent = `Showing all ${count} products`;
                }
            }
        }

        // Filter search results
        function filterSearch(category) {
            appState.currentFilter = category;
            
            // Update filter tabs
            document.querySelectorAll('.filter-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            event.currentTarget.classList.add('active');
            
            populateSearchResults();
        }

        // Search functionality from home page
        function performSearch() {
            const searchInput = document.querySelector('#main-search');
            const query = searchInput.value.trim();
            
            if (query) {
                appState.searchQuery = query;
                navigateToPage('search');
            }
        }

        // Search functionality from search page
        function performSearchOnPage() {
            const searchInput = document.getElementById('search-page-input');
            const query = searchInput.value.trim();
            
            appState.searchQuery = query;
            populateSearchResults();
        }

        // Category filtering from home page
        function filterByCategory(category) {
            appState.currentFilter = category;
            appState.searchQuery = '';
            navigateToPage('search');
        }

        // Checkout process
        function proceedToCheckout() {
            if (appState.cartItems.length === 0) return;
            
            const orderTotal = calculateOrderTotal();
            showNotification('Order Placed!', 0);
            
            // Add order to history (simulate)
            const newOrderId = `ORD-2024-${String(Math.floor(Math.random() * 1000)).padStart(3, '0')}`;
            
            // Clear cart
            appState.cartItems = [];
            appState.cartCount = 0;
            appState.cartTotal = 0;
            
            updateCartDisplay();
            renderCartItems();
            
            // Navigate to orders page
            setTimeout(() => {
                navigateToPage('orders');
            }, 2000);
        }

        // Calculate order total
        function calculateOrderTotal() {
            const subtotal = appState.cartTotal;
            const deliveryFee = appState.deliveryMode === 'delivery' ? 2.99 : 0;
            const tax = subtotal * 0.08;
            return subtotal + deliveryFee + tax;
        }

        // Reorder items
        function reorderItems(itemNames) {
            itemNames.forEach(itemName => {
                const product = products.find(p => p.name === itemName);
                if (product) {
                    addToCart(product.name, product.price, product.emoji);
                }
            });
            
            showNotification('Items added to cart!', 0);
            setTimeout(() => {
                navigateToPage('cart');
            }, 1500);
        }

        // Track order
        function trackOrder(orderId) {
            showNotification(`Tracking order ${orderId}`, 0);
        }

        // Settings pages
        function showSettingsPage(settingType) {
            const settingNames = {
                'addresses': 'Delivery Addresses',
                'payment': 'Payment Methods',
                'notifications': 'Notifications',
                'referral': 'Referral Program'
            };
            
            showNotification(`Opening ${settingNames[settingType]}...`, 0);
        }

        // Show notification
        function showNotification(itemName, price) {
            // Remove existing notifications
            const existingNotifications = document.querySelectorAll('.notification');
            existingNotifications.forEach(notification => notification.remove());
            
            const notification = document.createElement('div');
            notification.className = 'notification';
            
            if (price > 0) {
                notification.innerHTML = `
                    <div class="notification-title">Added to Cart! 🎉</div>
                    <div class="notification-body">${itemName} - ${price.toFixed(2)}</div>
                    <div class="notification-total">Cart Total: ${appState.cartTotal.toFixed(2)}</div>
                `;
            } else {
                notification.innerHTML = `
                    <div class="notification-title">${itemName}</div>
                `;
            }
            
            document.body.appendChild(notification);
            
            // Show notification
            setTimeout(() => {
                notification.classList.add('show');
            }, 100);
            
            // Hide notification after 3 seconds
            setTimeout(() => {
                notification.classList.remove('show');
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.remove();
                    }
                }, 400);
            }, 3000);
        }

        // Create ripple effect
        function createRippleEffect(event) {
            const button = event.currentTarget;
            const ripple = document.createElement('span');
            const rect = button.getBoundingClientRect();
            const size = Math.max(rect.width, rect.height);
            const x = event.clientX - rect.left - size / 2;
            const y = event.clientY - rect.top - size / 2;
            
            ripple.style.cssText = `
                position: absolute;
                width: ${size}px;
                height: ${size}px;
                left: ${x}px;
                top: ${y}px;
                background: rgba(255, 107, 53, 0.3);
                border-radius: 50%;
                transform: scale(0);
                pointer-events: none;
                animation: ripple 0.6s ease-out;
            `;
            
            // Add ripple animation if not exists
            if (!document.querySelector('#ripple-animation')) {
                const style = document.createElement('style');
                style.id = 'ripple-animation';
                style.textContent = `
                    @keyframes ripple {
                        to { transform: scale(2); opacity: 0; }
                    }
                `;
                document.head.appendChild(style);
            }
            
            button.style.position = 'relative';
            button.style.overflow = 'hidden';
            button.appendChild(ripple);
            
            setTimeout(() => {
                if (ripple.parentNode) {
                    ripple.remove();
                }
            }, 600);
        }

        // Initialize entrance animations
        function initializeAnimations() {
            const elements = document.querySelectorAll('.animate-entrance');
            
            const observer = new IntersectionObserver((entries) => {
                entries.forEach((entry, index) => {
                    if (entry.isIntersecting) {
                        setTimeout(() => {
                            entry.target.classList.add('visible');
                        }, index * 100);
                        observer.unobserve(entry.target);
                    }
                });
            }, { threshold: 0.1 });
            
            elements.forEach(el => {
                observer.observe(el);
            });
        }

        // Initialize progress bar animation
        function initializeProgressBar() {
            const progressFill = document.getElementById('progress-fill');
            if (progressFill) {
                progressFill.style.width = '0%';
            }
        }

        // Handle search input enter key
        document.addEventListener('keypress', function(event) {
            if (event.key === 'Enter') {
                if (event.target.id === 'main-search') {
                    performSearch();
                } else if (event.target.id === 'search-page-input') {
                    performSearchOnPage();
                }
            }
        });

        // Add touch feedback for mobile
        document.addEventListener('touchstart', function(event) {
            const target = event.target.closest('.product-card, .category-item, .toggle-btn, .order-btn');
            if (target) {
                target.style.transform = 'scale(0.98)';
            }
        });

        document.addEventListener('touchend', function(event) {
            const target = event.target.closest('.product-card, .category-item, .toggle-btn, .order-btn');
            if (target) {
                setTimeout(() => {
                    target.style.transform = '';
                }, 150);
            }
        });

        // Prevent double-tap zoom on buttons
        document.addEventListener('touchend', function(event) {
            const target = event.target.closest('button, .nav-item, .product-card');
            if (target) {
                event.preventDefault();
            }
        });

        // Add keyboard navigation support
        document.addEventListener('keydown', function(event) {
            if (event.key === 'Tab') {
                document.body.classList.add('keyboard-navigation');
            }
        });

        document.addEventListener('mousedown', function() {
            document.body.classList.remove('keyboard-navigation');
        });
    </script>

    <style>
        /* Additional styles for keyboard navigation */
        .keyboard-navigation button:focus,
        .keyboard-navigation .nav-item:focus,
        .keyboard-navigation .product-card:focus {
            outline: 2px solid #ff6b35;
            outline-offset: 2px;
        }

        /* Improved focus styles */
        button:focus,
        .nav-item:focus,
        .search-input:focus {
            outline: none;
            box-shadow: 0 0 0 2px #ff6b35;
        }

        /* Reduced motion support */
        @media (prefers-reduced-motion: reduce) {
            .animate-entrance,
            .notification,
            .progress-fill,
            .product-card,
            .category-item {
                transition: none;
                animation: none;
            }
        }

        /* Print styles */
        @media print {
            .bottom-nav,
            .notification,
            .search-bar {
                display: none;
            }
        }
    </style>
</body>
</html>